---
title: Simulation Epidemiology
subtitle: A simulation study on the effect of network structure on epidemiological measurements</text><br>Sunbelt 2023<br>Portland, Oregon
author: 
  - George G. Vega Yon
  - Chong Zhang
  - Alun Thomas
  - Matthew Samore
  - Karim Khader
aspectratio: 169
date: 2023-06-28
format:
  revealjs:
    slide-number: true
    footer: Vega Yon et al -- ggv.cl/slides/sunbelt2023
    theme: ["default", "style.scss"]
    title-slide-attributes: 
      data-background-image: 'Zoom-Background_PrideU.jpg'
      data-background-opacity: '0.2'
      data-background-size: 'contain'
    fig-align: center
    embed-resources: true
---

# Motivation {background-color="#890000"}

## *Rt* in Small World Networks 

::: {.columns}
::: {.column .fragment .fade-up width="45%"}



![Herd Immunity Threshold vs Reproductive Number [(Wikipedia)](https://commons.wikimedia.org/wiki/File:Herd_immunity_threshold_vs_r0.svg)](https://upload.wikimedia.org/wikipedia/commons/0/0f/Herd_immunity_threshold_vs_r0.svg){width=70%}

- Rt > 1: Epidemic grows.
- Rt < 1: Epidemic shrinks.
:::

::: {.column .fragment .fade-up width="45%"}

But...

![](data/small-world-example.png){width=70%}

Reproduction Number in an **SIR + small world network is on average <1**!

::: 
:::

## An odd behavior of Rt

::: {style="font-size:120%"}
> **Goal**: Understand how network structure affects epidemiological measurements.
:::

::: {.fragment .fade-up}
**Why?**
:::

::: {.fragment .fade-up}
- In Agent-Based Models the network structure is a key component.
:::

::: {.fragment .fade-up}
- Understanding **how network structure affects epidemiological measurements** will help us understand how to design **better models**.
:::


# Simulation Study {background-color="#890000"}

## Setup: Simulation study

DIAGRAM OF THE SIMULATION STUDY SHOWING THE SEIR MODEL AND THE NETWORK MODELS

- Recovery rate: $1/7$ (one week's worth).

- Mean degree: 14 (contact rate).

- Reproductive number of ~2.

- Transmission rate of ~0.023.[^tratecomputation]

- 100 days

<!-- $RepNum = C_{rate} \times p_t\sum_{k = 0}(1 - p_r)(1 - p_t) = \frac{C_rate}{1 - (1 - p_r)(1 - p_t)}p_t$

RepNum = 2 and $p_r = 1/7$

Therefore, -->

[^tratecomputation]: To calculate the transmission rate, we use the following formula: $p_t = \frac{p_r}{(C/R + p_r - 1)}$, with C = 14, R = 2, and $p_r = 1/7$

## Setup: What we measured

::: {.columns}

::: {.column width=50%}

Epi measurements

![](data/figures/diagrams-stats.svg){width=100%}

:::

::: {.column width=50%}

Diagram of network variables

:::
:::


## Network features

![](data/figures/03-report-ergm-vars.png){fig-align="center"}

## Network features (cont.)

![](data/figures/03-report-igraph-vars.png){fig-align="center"}

# Preliminary results {background-color="#890000"}

## Overall distribution of epidemiological measurements

![](data/figures/03-report-pairwise.png){fig-align="center"}

## *Rt* curve

![](data/figures/04-repnums-rt-by-nettype.png){fig-align="center"}

## Variance: Reproductive number

![](data/figures/05-variance-rt.png){fig-align="center"}

## Variance: Peak time

![](data/figures/05-variance-peak-time.png){fig-align="center"}

## Variance: Peak prevalence

![](data/figures/05-variance-peak-preval.png){fig-align="center"}

## Variance: Generation time

![](data/figures/05-variance-gentime.png){fig-align="center"}

# Predicting epidemiological measurements {background-color="#890000"}

## Regression analyses

<!--
#e41a1c
#377eb8
#4daf4a
#984ea3
-->

```{r}
#| echo: false
colo <- function(...) {
  sprintf(
    '<text style="color: #%s;font-weight: bold">%s</text>',
    gsub("'", "", as.character(match.call()[[3]])),
    gsub("'", "", as.character(match.call()[[2]]))
  )
}

Rt <- colo('Rt', 'e41a1c')
Gt <- colo('Gen time', '377eb8')
Pt <- colo('Peak time', '4daf4a')
Pp <- colo('Peak preval', '984ea3')

# colo(R, fff)
```

Regressed *`r Rt`*, *`r Gt`*, *`r Pt`*, and *`r Pp`* on network features (n = 18,015)

::: {.columns style="font-size: 80%;"}

::: {.column width="30%"}
::: {.fragment}
- Avg. degree {{< fa regular hand-point-up >}} `r Pt` and {{< fa regular hand-point-down >}} `r Gt`.
:::

::: {.fragment}
- Higher number of two-paths {{< fa regular hand-point-down >}} `r Pt` and `r Rt`, but {{< fa regular hand-point-up >}} the `r Pp` (more severe).
:::

::: {.fragment}
- Transitivity {{< fa regular hand-point-down >}} `r Pp` and {{< fa regular hand-point-up >}} `r Gt`.
:::

::: {.fragment}
- Triangles {{< fa regular hand-point-up >}} the `r Pt`.
:::

::: {.fragment}
- Higher balance significantly {{< fa regular hand-point-up >}} `r Rt`.
:::
:::

::: {.column width="70%"}
![](data/figures/03-report-coefficients.png){fig-align="center" width=100%}
:::

:::

::: {.fragment style="font-size: 80%;"}
- Degree-sequence and Erdos-Renyi networks have consistently {{< fa regular hand-point-up >}} `r Pp` and {{< fa regular hand-point-up >}} `r Pt`.
:::

::: {.fragment style="font-size: 80%;"}
- Scale-free networks have {{< fa regular hand-point-down >}} `r Pt` and {{< fa regular hand-point-up >}} `r Rt`.
:::
## Discussion

- High heterogeneity in variance.

- Scale-free networks show a high variance across outcomes.

- `r Rt` is hard to predict as a network function.

- Our study only looks at small networks. We need to dive deep into large network models.

- Small permutation in small networks -> flat `r Rt` close to 1.

## Fin

::: {style="font-size: 120%; text-align: center;"}
Thank you!
:::
