---
title: Simulation Epidemiology
subtitle: A simulation study on the effect of network structure on epidemiological measurements</text><br>Sunbelt 2023<br>Portland, Oregon
author: 
  - George G. Vega Yon
  - Chong Zhang
  - Alun Thomas
  - Matthew Samore
  - Karim Khader
aspectratio: 169
date: 2023-06-28
format:
  revealjs:
    slide-number: true
    footer: Vega Yon et al -- ggv.cl/slides/sunbelt2023
    theme: ["default", "style.scss"]
    title-slide-attributes: 
      data-background-image: 'Zoom-Background_PrideU.jpg'
      data-background-opacity: '0.2'
      data-background-size: 'contain'
    fig-align: center
---

# Motivation {background-color="#890000"}

## *Rt* in Small World Networks 

::: {.columns}
::: {.column .fragment .fade-up width="45%"}



![Herd Immunity Threshold vs Reproductive Number [(Wikipedia)](https://commons.wikimedia.org/wiki/File:Herd_immunity_threshold_vs_r0.svg)](https://upload.wikimedia.org/wikipedia/commons/0/0f/Herd_immunity_threshold_vs_r0.svg){width=70%}

- Rt > 1: Epidemic grows.
- Rt < 1: Epidemic shrinks.
:::

::: {.column .fragment .fade-up width="45%"}

But...

![](data/small-world-example.png){width=70%}

Reproduction Number in an **SIR + small world network is on average <1**!

::: 
:::

## An odd behavior of Rt

::: {style="font-size:120%"}
> **Goal**: Understand how network structure affects epidemiological measurements.
:::

::: {.fragment .fade-up}
**Why?**
:::

::: {.fragment .fade-up}
- In Agent-Based Models the network structure is a key component.
:::

::: {.fragment .fade-up}
- Understanding **how network structure affects epidemiological measurements** will help us understand how to design **better models**.
:::


# Simulation Study

## Setup

<!-- Diagram with setup: ergm -> all other graphs -->

- To test this, we conducted a large simulation study looking into the following epidemiological measurements:

    - Reproductive number.
    - Peak prevalence.
    - Peak time.
    - Generation time


- We have a population of 1000 individuals.

- We have a disease that is transmitted by contact.

- We used a Susceptible-Exposed-Infected-Recovered [SEIR] model.

- For each SEIR simulation we:

    a. We generated a network with a given set of parameters.

    b. We simulated the disease outbreak on the network.

    c. We computed the epidemiological measurements.

## Simulation paramters

- Recovery rate: $1/7$ (one week's worth).

- Mean degree: 14 (contact rate).

- Reproductive number of ~2.

- Transmission rate of ~0.023.[^tratecomputation]

- 100 days

<!-- $RepNum = C_{rate} \times p_t\sum_{k = 0}(1 - p_r)(1 - p_t) = \frac{C_rate}{1 - (1 - p_r)(1 - p_t)}p_t$

RepNum = 2 and $p_r = 1/7$

Therefore, -->

[^tratecomputation]: To calculate the transmission rate, we use the following formula: $p_t = \frac{p_r}{(C/R + p_r - 1)}$, with C = 14, R = 2, and $p_r = 1/7$

## Network features

![](data/figures/03-report-ergm-vars.png){fig-align="center"}

## Network features (cont.)

![](data/figures/03-report-igraph-vars.png){fig-align="center"}

# Preliminary results {background-color="#890000"}

## Overall distribution of epidemiological measurements

![](data/figures/03-report-pairwise.png){fig-align="center"}

## Variance: Reproductive number

![](data/figures/05-variance-rt.png){fig-align="center"}

## Variance: Peak time

![](data/figures/05-variance-peak-time.png){fig-align="center"}

## Variance: Peak prevalence

![](data/figures/05-variance-peak-preval.png){fig-align="center"}

## Variance: Generation time

![](data/figures/05-variance-gentime.png){fig-align="center"}

# Predicting epidemiological measurements {background-color="#890000"}

## Regression analyses

<!-- #e41a1c
#377eb8
#4daf4a
#984ea3 -->

```{r}
colo <- function(x, pal) {
  as.character(match.call()[[2]])
}

colo(R)
```

Regressed *Rt*, *Gen time*, *Peak time*, and *Peak preval* on network features.

::: {.columns style="font-size: 80%;"}

::: {.column width="30%"}

- Higher balance significantly increases Rt.

- Higher number of two-paths reduces Peak time and Rt, but increases the peak size (more severe).

- Triangles push the peak time.
:::

::: {.column width="70%"}
![](data/figures/03-report-coefficients.png){fig-align="center" width=100%}
:::

:::

## Discussion

- We care about networks.

- Different networks have different effects the spreading of infectious diseases.

- We need to understand how network structure affects epidemiological measurements.

- We developed a simulation study to look into this question.

- We found that network structure has a significant effect on epidemiological measurements.


## Fin

::: {style="font-size: 120%; text-align: center;"}
Thank you!
:::
